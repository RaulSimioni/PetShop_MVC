{% extends "base.html" %}

{% block title %}Dashboard - PetShop ERP{% endblock %}

{% block content %}
<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
    <h1 class="h2">
        <span class="material-symbols-outlined me-2" style="font-size: 2rem; vertical-align: middle;">dashboard</span> Dashboard
    </h1>
    <div class="btn-toolbar mb-2 mb-md-0">
        <div class="btn-group me-2">
            <button type="button" class="btn btn-sm btn-outline-secondary dropdown-toggle" data-bs-toggle="dropdown">
                <span class="material-symbols-outlined me-1">download</span> Relatórios
            </button>
            <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="#">Relatório de Clientes</a></li>
                <li><a class="dropdown-item" href="#">Relatório de Pets</a></li>
                <li><a class="dropdown-item" href="#">Relatório de Agendamentos</a></li>
            </ul>
        </div>
    </div>
</div>

<!-- Cards de estatísticas - Primeira linha -->
<div class="row mb-4 dashboard-stats">
    <div class="col-md-3">
        <div class="card border-0 h-100">
            <div class="card-body text-center">
                <span class="material-symbols-outlined mb-2" style="color: var(--primary-color); font-size: 2.5rem; display: block;">group</span>
                <h4 class="card-title">{{ stats.total_clientes or 0 }}</h4>
                <p class="card-text text-muted">Clientes</p>
                <small class="text-success">{{ stats.clientes_ativos or 0 }} ativos</small>
            </div>
            <div class="card-footer bg-transparent">
                <a href="{{ url_for('cliente_views.listar_clientes') }}" class="btn btn-primary btn-sm w-100">
                    <span class="material-symbols-outlined me-1">visibility</span>Ver Clientes
                </a>
            </div>
        </div>
    </div>

    <div class="col-md-3">
        <div class="card border-0 h-100">
            <div class="card-body text-center">
                <span class="material-symbols-outlined mb-2" style="color: var(--success-color); font-size: 2.5rem; display: block;">pets</span>
                <h4 class="card-title">{{ stats.total_pets or 0 }}</h4>
                <p class="card-text text-muted">Pets</p>
                <small class="text-info">{{ stats.pets_ativos or 0 }} ativos</small>
            </div>
            <div class="card-footer bg-transparent">
                <a href="/pets" class="btn btn-success btn-sm w-100">
                    <span class="material-symbols-outlined me-1">visibility</span>Ver Pets
                </a>
            </div>
        </div>
    </div>

    <div class="col-md-3">
        <div class="card border-0 h-100">
            <div class="card-body text-center">
                <span class="material-symbols-outlined mb-2" style="color: var(--info-color); font-size: 2.5rem; display: block;">badge</span>
                <h4 class="card-title">{{ stats.total_funcionarios or 0 }}</h4>
                <p class="card-text text-muted">Funcionários</p>
                <small class="text-success">{{ stats.funcionarios_ativos or 0 }} ativos</small>
            </div>
            <div class="card-footer bg-transparent">
                <a href="{{ url_for('funcionario_views.listar_funcionarios') }}" class="btn btn-info btn-sm w-100">
                    <span class="material-symbols-outlined me-1">visibility</span>Ver Funcionários
                </a>
            </div>
        </div>
    </div>

    <div class="col-md-3">
        <div class="card border-0 h-100">
            <div class="card-body text-center">
                <span class="material-symbols-outlined mb-2" style="color: var(--warning-color); font-size: 2.5rem; display: block;">design_services</span>
                <h4 class="card-title">{{ stats.total_servicos or 0 }}</h4>
                <p class="card-text text-muted">Serviços</p>
                <small class="text-success">{{ stats.servicos_ativos or 0 }} ativos</small>
            </div>
            <div class="card-footer bg-transparent">
                <a href="{{ url_for('servico_views.listar') }}" class="btn btn-warning btn-sm w-100">
                    <span class="material-symbols-outlined me-1">visibility</span>Ver Serviços
                </a>
            </div>
        </div>
    </div>
</div>

<!-- Cards de estatísticas - Segunda linha (Agendamentos) -->
<div class="row mb-4 dashboard-stats">
    <div class="col-md-3">
        <div class="card border-0 h-100">
            <div class="card-body text-center">
                <span class="material-symbols-outlined mb-2" style="color: var(--success-color); font-size: 2.5rem; display: block;">event_available</span>
                <h4 class="card-title">{{ stats.agendamentos_hoje or 0 }}</h4>
                <p class="card-text text-muted">Agend. Hoje</p>
                <small class="text-primary">Dia atual</small>
            </div>
            <div class="card-footer bg-transparent">
                <a href="{{ url_for('agendamento_views.listar') }}" class="btn btn-success btn-sm w-100">
                    <span class="material-symbols-outlined me-1">today</span>Ver Hoje
                </a>
            </div>
        </div>
    </div>

    <div class="col-md-3">
        <div class="card border-0 h-100">
            <div class="card-body text-center">
                <span class="material-symbols-outlined mb-2" style="color: var(--warning-color); font-size: 2.5rem; display: block;">schedule</span>
                <h4 class="card-title">{{ stats.agendamentos_pendentes or 0 }}</h4>
                <p class="card-text text-muted">Pendentes</p>
                <small class="text-warning">Aguardando</small>
            </div>
            <div class="card-footer bg-transparent">
                <a href="{{ url_for('agendamento_views.listar') }}" class="btn btn-warning btn-sm w-100">
                    <span class="material-symbols-outlined me-1">pending_actions</span>Ver Pendentes
                </a>
            </div>
        </div>
    </div>

    <div class="col-md-3">
        <div class="card border-0 h-100">
            <div class="card-body text-center">
                <span class="material-symbols-outlined mb-2" style="color: var(--primary-color); font-size: 2.5rem; display: block;">event</span>
                <h4 class="card-title">{{ stats.total_agendamentos or 0 }}</h4>
                <p class="card-text text-muted">Total Agend.</p>
                <small class="text-info">Histórico</small>
            </div>
            <div class="card-footer bg-transparent">
                <a href="{{ url_for('agendamento_views.listar') }}" class="btn btn-primary btn-sm w-100">
                    <span class="material-symbols-outlined me-1">visibility</span>Ver Todos
                </a>
            </div>
        </div>
    </div>

    <div class="col-md-3">
        <div class="card border-0 h-100">
            <div class="card-body text-center">
                <span class="material-symbols-outlined mb-2" style="color: var(--info-color); font-size: 2.5rem; display: block;">add_circle</span>
                <h4 class="card-title">Novo</h4>
                <p class="card-text text-muted">Agendamento</p>
                <small class="text-success">Criar agora</small>
            </div>
            <div class="card-footer bg-transparent">
                <a href="{{ url_for('agendamento_views.novo') }}" class="btn btn-info btn-sm w-100">
                    <span class="material-symbols-outlined me-1">add</span>Agendar
                </a>
            </div>
        </div>
    </div>
</div>

<!-- Ações rápidas -->
<div class="row mb-4">
    <div class="col-md-12">
        <div class="card">
            <div class="card-header">
                <h5 class="card-title mb-0">
                    <span class="material-symbols-outlined text-warning me-2">bolt</span> Ações Rápidas
                </h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-2 mb-3">
                        <a href="{{ url_for('cliente_views.novo_cliente') }}" class="btn btn-primary w-100 py-3">
                            <span class="material-symbols-outlined mb-2" style="display: block; font-size: 1.5rem;">person_add</span>
                            Novo Cliente
                        </a>
                    </div>
                    <div class="col-md-2 mb-3">
                        <a href="/pets/novo" class="btn btn-success w-100 py-3">
                            <span class="material-symbols-outlined mb-2" style="display: block; font-size: 1.5rem;">pets</span>
                            Cadastrar Pet
                        </a>
                    </div>
                    <div class="col-md-2 mb-3">
                        <a href="{{ url_for('funcionario_views.novo_funcionario') }}" class="btn btn-info w-100 py-3">
                            <span class="material-symbols-outlined mb-2" style="display: block; font-size: 1.5rem;">person_add</span>
                            Novo Funcionário
                        </a>
                    </div>
                    <div class="col-md-2 mb-3">
                        <a href="{{ url_for('servico_views.novo') }}" class="btn btn-warning w-100 py-3">
                            <span class="material-symbols-outlined mb-2" style="display: block; font-size: 1.5rem;">design_services</span>
                            Novo Serviço
                        </a>
                    </div>
                    <div class="col-md-2 mb-3">
                        <a href="{{ url_for('agendamento_views.novo') }}" class="btn btn-secondary w-100 py-3">
                            <span class="material-symbols-outlined mb-2" style="display: block; font-size: 1.5rem;">event_available</span>
                            Agendar Serviço
                        </a>
                    </div>
                    <div class="col-md-2 mb-3">
                        <a href="{{ url_for('agendamento_views.listar') }}" class="btn btn-outline-primary w-100 py-3">
                            <span class="material-symbols-outlined mb-2" style="display: block; font-size: 1.5rem;">calendar_view_day</span>
                            Agenda
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Clientes recentes e Agendamentos do dia -->
<div class="row">
    <div class="col-md-6">
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="card-title mb-0">
                    <span class="material-symbols-outlined me-2">group</span> Clientes Recentes
                </h5>
                <a href="{{ url_for('cliente_views.listar_clientes') }}" class="btn btn-sm btn-outline-primary">
                    Ver Todos
                </a>
            </div>
            <div class="card-body">
                {% if clientes_recentes %}
                <div class="list-group list-group-flush">
                    {% for cliente in clientes_recentes %}
                    <div class="list-group-item d-flex justify-content-between align-items-center">
                        <div>
                            <strong>{{ cliente.nome }}</strong><br>
                            <small class="text-muted">{{ cliente.telefone }}</small>
                        </div>
                        <div>
                            <span class="badge bg-light text-dark">
                                {{ cliente.data_cadastro.strftime('%d/%m') if cliente.data_cadastro else 'N/A' }}
                            </span>
                            <a href="{{ url_for('cliente_views.visualizar_cliente', cliente_id=cliente.id) }}" 
                               class="btn btn-sm btn-outline-info ms-2">
                                <span class="material-symbols-outlined">visibility</span>
                            </a>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                {% else %}
                <div class="text-center py-3">
                    <span class="material-symbols-outlined text-muted mb-3" style="font-size: 3rem; display: block;">group_off</span>
                    <p class="text-muted">Nenhum cliente cadastrado</p>
                    <a href="{{ url_for('cliente_views.novo_cliente') }}" class="btn btn-primary">
                        Cadastrar Primeiro Cliente
                    </a>
                </div>
                {% endif %}
            </div>
        </div>
    </div>

    <div class="col-md-6">
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="card-title mb-0">
                    <span class="material-symbols-outlined me-2">today</span> Agendamentos de Hoje
                </h5>
                <a href="{{ url_for('agendamento_views.listar') }}" class="btn btn-sm btn-outline-info">
                    Ver Agenda
                </a>
            </div>
            <div class="card-body">
                {% if agendamentos_hoje %}
                <div class="list-group list-group-flush">
                    {% for agendamento in agendamentos_hoje %}
                    <div class="list-group-item d-flex justify-content-between align-items-center">
                        <div>
                            <strong>{{ agendamento.cliente.nome if agendamento.cliente else 'Cliente N/I' }}</strong><br>
                            <small class="text-muted">
                                {{ agendamento.data_agendamento.strftime('%H:%M') if agendamento.data_agendamento else 'N/A' }}
                                - {{ agendamento.servico.nome if agendamento.servico else 'Serviço N/I' }}
                            </small>
                        </div>
                        <div>
                            <span class="badge bg-warning">
                                Agendado
                            </span>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                {% else %}
                <div class="text-center py-3">
                    <span class="material-symbols-outlined text-muted mb-3" style="font-size: 3rem; display: block;">event_busy</span>
                    <p class="text-muted">Nenhum agendamento para hoje</p>
                    <a href="{{ url_for('agendamento_views.novo') }}" class="btn btn-info">
                        Novo Agendamento
                    </a>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}
